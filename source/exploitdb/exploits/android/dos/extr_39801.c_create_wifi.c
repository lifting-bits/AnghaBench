#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_18__   TYPE_9__ ;
typedef  struct TYPE_17__   TYPE_8__ ;
typedef  struct TYPE_16__   TYPE_7__ ;
typedef  struct TYPE_15__   TYPE_6__ ;
typedef  struct TYPE_14__   TYPE_5__ ;
typedef  struct TYPE_13__   TYPE_4__ ;
typedef  struct TYPE_12__   TYPE_3__ ;
typedef  struct TYPE_11__   TYPE_2__ ;
typedef  struct TYPE_10__   TYPE_1__ ;

/* Type definitions */
typedef  char u8 ;
struct TYPE_15__ {int tl; int /*<<< orphan*/  tn; } ;
struct TYPE_16__ {void* tl; int /*<<< orphan*/  tn; } ;
struct TYPE_14__ {char* oui; int type; } ;
struct TYPE_13__ {char* oui; int type; } ;
struct TYPE_12__ {char* oui; int type; } ;
struct TYPE_11__ {char* oui; int type; } ;
struct TYPE_10__ {char* oui; int type; } ;
struct TYPE_17__ {char* oui; int type; } ;
struct TYPE_18__ {char* rates; int channel; int erp_info; int version; int pcs_count; int akm_count; int rsn; int ucs_count; int info; int mpdu; int* scheme; int capabilities; int subset1; int subset2; TYPE_7__ head; TYPE_5__ akm; TYPE_4__ ucs; TYPE_3__ mcs; TYPE_2__ wpa_o; TYPE_1__ pcs; TYPE_8__ gcp; } ;
struct ssid {char* dest; char* source; char* bssid; char* ssid; TYPE_6__ head; TYPE_9__ ht_info; TYPE_9__ ht_capabilites; TYPE_9__ wpa; TYPE_9__ rsn_info; TYPE_9__ esr; TYPE_9__ erp_info; TYPE_9__ ds; TYPE_9__ rates; int /*<<< orphan*/  type; } ;
struct ie80211_hdr {char* dest; char* source; char* bssid; char* ssid; TYPE_6__ head; TYPE_9__ ht_info; TYPE_9__ ht_capabilites; TYPE_9__ wpa; TYPE_9__ rsn_info; TYPE_9__ esr; TYPE_9__ erp_info; TYPE_9__ ds; TYPE_9__ rates; int /*<<< orphan*/  type; } ;
struct Wifi_Tags {char* dest; char* source; char* bssid; char* ssid; TYPE_6__ head; TYPE_9__ ht_info; TYPE_9__ ht_capabilites; TYPE_9__ wpa; TYPE_9__ rsn_info; TYPE_9__ esr; TYPE_9__ erp_info; TYPE_9__ ds; TYPE_9__ rates; int /*<<< orphan*/  type; } ;
typedef  int /*<<< orphan*/  radiotap_hdr ;
typedef  int /*<<< orphan*/  fixed_hdr ;

/* Variables and functions */
 char* DESTINATION_MAC ; 
 int /*<<< orphan*/  DS_t ; 
 int /*<<< orphan*/  ERP_t ; 
 char* ESRATES_v ; 
 int /*<<< orphan*/  ESR_t ; 
 int /*<<< orphan*/  HTC_t ; 
 int /*<<< orphan*/  HTI_t ; 
 char* OUI_AES ; 
 char* OUI_Microsof ; 
 int /*<<< orphan*/  PROBE_RESPONSE ; 
 int /*<<< orphan*/  RATES_t ; 
 char* RATES_v ; 
 int /*<<< orphan*/  RSN_t ; 
 char* SOURCE_MAC ; 
 char* SSID ; 
 int /*<<< orphan*/  SSID_t ; 
 int /*<<< orphan*/  VENDOR_t ; 
 void* calc_size (TYPE_9__) ; 
 void* calloc (int,int) ; 
 int /*<<< orphan*/  free (struct ssid*) ; 
 int /*<<< orphan*/  memcpy (char*,char*,int) ; 
 int /*<<< orphan*/  memset (char*,char,int) ; 
 int /*<<< orphan*/  reverse8 (int /*<<< orphan*/ ) ; 
 int strlen (char*) ; 

int
create_wifi(char *pop)
{
    /*
     *  struct for radiotap_hdr and fixed_hdr are missing
     */
    char radiotap_hdr[26];
    char fixed_hdr[12];
    struct ie80211_hdr *ie = calloc( sizeof(struct ie80211_hdr), 1 );
    struct Wifi_Tags *tag = calloc( sizeof(struct Wifi_Tags), 1 );
    struct ssid *ssid;
    int i, len = 0;

    memset( radiotap_hdr, 0, sizeof(radiotap_hdr) );
    radiotap_hdr[2] = 26;	/* Header Length */

    memset( fixed_hdr, 'A', sizeof(fixed_hdr) );

    ie->type = reverse8(PROBE_RESPONSE);
    memcpy( ie->dest, DESTINATION_MAC, 6 );
    memcpy( ie->source, SOURCE_MAC, 6 );
    memcpy( ie->bssid, SOURCE_MAC, 6 );

    i = strlen( SSID );
    ssid = calloc( i+2, 1 );
    ssid->head.tn = SSID_t;
    ssid->head.tl = i;
    ssid->ssid = calloc(i,1);
    memcpy( ssid->ssid, SSID, i );

    tag->rates.head.tn = RATES_t;
    tag->rates.head.tl = calc_size(tag->rates);
    memcpy(tag->rates.rates, RATES_v, sizeof(tag->rates.rates));

    tag->ds.head.tn = DS_t;
    tag->ds.head.tl = calc_size(tag->ds);
    tag->ds.channel = 1;

    tag->erp_info.head.tn = ERP_t;
    tag->erp_info.head.tl = calc_size(tag->erp_info);
    tag->erp_info.erp_info = 0x00;

    tag->esr.head.tn = ESR_t;
    tag->esr.head.tl = calc_size(tag->esr);
    memcpy(tag->esr.rates, ESRATES_v, sizeof(tag->esr.rates));

    tag->rsn_info.head.tn = RSN_t;
    tag->rsn_info.head.tl = calc_size(tag->rsn_info);
    tag->rsn_info.version = 1;

    memcpy( tag->rsn_info.gcp.oui, OUI_AES, 	\
			sizeof(tag->rsn_info.gcp.oui) );
    tag->rsn_info.gcp.type = 0x04;	/* AES(CCM) */

    tag->rsn_info.pcs_count = 1;
    memcpy( tag->rsn_info.pcs.oui, OUI_AES, 	\
			sizeof(tag->rsn_info.pcs.oui) );
    tag->rsn_info.pcs.type = 0x04;	/* AES(CCM) */

    tag->rsn_info.akm_count = 1;
    memcpy( tag->rsn_info.akm.oui, OUI_AES, 	\
			sizeof(tag->rsn_info.akm.oui) );
    tag->rsn_info.pcs.type = 0x02;

    tag->rsn_info.rsn = 0x0000;

    tag->wpa.head.tn = VENDOR_t;
    tag->wpa.head.tl = calc_size(tag->wpa);
    memcpy( tag->wpa.wpa_o.oui, OUI_Microsof, 	\
			sizeof(tag->wpa.wpa_o.oui) );
    tag->wpa.wpa_o.type = 1;
    tag->wpa.version = 1;

    memcpy( tag->wpa.mcs.oui, OUI_Microsof, 	\
			sizeof(tag->wpa.mcs.oui) );
    tag->wpa.mcs.type = 0x04;
    tag->wpa.ucs_count = 1;
    memcpy( tag->wpa.ucs.oui, OUI_Microsof, 	\
			sizeof(tag->wpa.ucs.oui) );
    tag->wpa.ucs.type = 0x04;

    tag->wpa.akm_count = 1;
    memcpy( tag->wpa.akm.oui, OUI_Microsof, 	\
			sizeof(tag->wpa.akm.oui) );
    tag->wpa.akm.type = 0x02;

    tag->ht_capabilites.head.tn = HTC_t;
    tag->ht_capabilites.head.tl = calc_size(tag->ht_capabilites);
    tag->ht_capabilites.info = 0x104e;
    tag->ht_capabilites.mpdu = 0x1f;
    tag->ht_capabilites.scheme[0] = 0xff;
    tag->ht_capabilites.scheme[1] = 0xff;
    tag->ht_capabilites.capabilities = 0x0004;

    tag->ht_info.head.tn = HTI_t;
    tag->ht_info.head.tl = calc_size(tag->ht_info);
    tag->ht_info.channel = 11;
    tag->ht_info.subset1 = 0x07;
    tag->ht_info.subset2 = 0x0001;
    tag->ht_info.scheme[0] = 0x0f;

    memcpy( pop, radiotap_hdr, sizeof(radiotap_hdr) );	
    memcpy( &pop[len+=sizeof(radiotap_hdr)], 		\
	    (u8 *)ie, sizeof(struct ie80211_hdr) ); 
    memcpy( &pop[len+=sizeof(struct ie80211_hdr)],	\
	    fixed_hdr, sizeof(fixed_hdr) );
    memcpy( &pop[len+=sizeof(fixed_hdr)], 		\
	    (u8 *)&ssid->head, 2 ); 
    memcpy( &pop[len+=2], ssid->ssid, i ); 
    memcpy( &pop[len+=i], (u8 *) tag, 			\
	    sizeof(struct Wifi_Tags) ); 
    len+=sizeof(struct Wifi_Tags);

    free( ssid );
    free( tag );
    free( ie );

    return (len);
}