#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct map_address_racer_context {size_t size; int running; int deallocated; int do_map; int restart; int success; int /*<<< orphan*/ * address; int /*<<< orphan*/  thread; } ;

/* Variables and functions */
 int /*<<< orphan*/  ERROR (char*,int) ; 
 int /*<<< orphan*/  allocate_map_address (int /*<<< orphan*/ **,size_t) ; 
 int /*<<< orphan*/  deallocate_map_address (int /*<<< orphan*/ *,size_t) ; 
 int /*<<< orphan*/  map_address_racer ; 
 int pthread_create (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ,struct map_address_racer_context*) ; 

__attribute__((used)) static bool start_map_address_racer(struct map_address_racer_context *context, size_t leak_size) {
	// Allocate the initial block of memory, fixing the address.
	context->address = NULL;
	context->size    = leak_size;
	if (!allocate_map_address(&context->address, context->size)) {
		goto fail_0;
	}
	// Start the racer thread.
	context->running     = true;
	context->deallocated = false;
	context->do_map      = false;
	context->restart     = false;
	context->success     = true;
	int err = pthread_create(&context->thread, NULL, map_address_racer, context);
	if (err) {
		ERROR("Could not create map_address_racer thread: errno %d", err);
		goto fail_1;
	}
	return true;
fail_1:
	deallocate_map_address(context->address, context->size);
fail_0:
	return false;
}