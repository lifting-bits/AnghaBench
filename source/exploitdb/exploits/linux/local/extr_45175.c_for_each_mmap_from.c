#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct mmap_entry {unsigned long start; unsigned long end; unsigned int flags; } ;
typedef  int /*<<< orphan*/  (* mmap_callback ) (struct mmap_entry*,void*) ;

/* Variables and functions */
 int /*<<< orphan*/  EXIT_FAILURE ; 
 int MAX_MMAPS_PER_TASK ; 
 int /*<<< orphan*/  O_VM_AREA_STRUCT_VM_END ; 
 int /*<<< orphan*/  O_VM_AREA_STRUCT_VM_FLAGS ; 
 int /*<<< orphan*/  O_VM_AREA_STRUCT_VM_NEXT ; 
 int /*<<< orphan*/  O_VM_AREA_STRUCT_VM_START ; 
 unsigned long TASK_SIZE ; 
 int /*<<< orphan*/  assert (int) ; 
 int /*<<< orphan*/  exit (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  info (char*) ; 
 unsigned int read_field_4 (unsigned long,int /*<<< orphan*/ ) ; 
 unsigned long read_field_8 (unsigned long,int /*<<< orphan*/ ) ; 

__attribute__((used)) static void for_each_mmap_from(unsigned long mmap, mmap_callback callback,
				void *private) {
	struct mmap_entry entries[MAX_MMAPS_PER_TASK];
	int i, count;

	count = 0;
	while (mmap != 0) {
		assert(count < MAX_MMAPS_PER_TASK);
		unsigned long vm_start =
			read_field_8(mmap, O_VM_AREA_STRUCT_VM_START);
		unsigned long vm_end =
			read_field_8(mmap, O_VM_AREA_STRUCT_VM_END);
		if (vm_start >= TASK_SIZE || vm_end >= TASK_SIZE) {
			info("[-] bad mmap (did the task die?)\n");
			exit(EXIT_FAILURE);
		}
		unsigned vm_flags =
			read_field_4(mmap, O_VM_AREA_STRUCT_VM_FLAGS);
		entries[count].start = vm_start;
		entries[count].end = vm_end;
		entries[count].flags = vm_flags;
		count++;
		mmap = read_field_8(mmap, O_VM_AREA_STRUCT_VM_NEXT);
	}

	for (i = 0; i < count; i++)
		callback(&entries[i], private);
}